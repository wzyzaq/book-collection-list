{"version":3,"file":"slider.js","sources":["../../../../../components/color-picker/components/panel/slider.tsx"],"sourcesContent":["import React, { useRef, useEffect } from 'react';\nimport classnames from 'classnames';\nimport { SLIDER_DEFAULT_WIDTH } from '@tdesign/common-js/color-picker/constants';\nimport useDrag, { Coordinate } from '../../../hooks/useDrag';\nimport { TdColorBaseProps } from '../../interface';\nimport useStyles from '../../hooks/useStyles';\n\nexport interface TdColorSliderProps extends TdColorBaseProps {\n  className?: string;\n  value?: Number;\n  maxValue?: Number;\n  railStyle?: Object;\n  type?: 'hue' | 'alpha';\n}\n\nconst ColorSlider = (props: TdColorSliderProps) => {\n  const {\n    color,\n    className = '',\n    value = 0,\n    railStyle = {},\n    maxValue = 360,\n    baseClassName,\n    disabled,\n    onChange,\n    type,\n  } = props;\n  const panelRef = useRef<HTMLDivElement>(null);\n  const thumbRef = useRef<HTMLElement>(null);\n  const isMovedRef = useRef<boolean>(false);\n  const panelRectRef = useRef({\n    width: SLIDER_DEFAULT_WIDTH,\n  });\n  const { styles } = useStyles({ color, value, maxValue }, panelRectRef);\n\n  const handleDrag = (coordinate: Coordinate, isEnded?: boolean) => {\n    if (disabled) {\n      return;\n    }\n    const { width } = panelRectRef.current;\n    const { x } = coordinate;\n    const value = Math.round((x / width) * Number(maxValue) * 100) / 100;\n    isMovedRef.current = true;\n    onChange(value, isEnded);\n  };\n\n  const handleDragEnd = (coordinate: Coordinate) => {\n    if (disabled || !isMovedRef.current) {\n      return;\n    }\n\n    handleDrag(coordinate, true);\n    isMovedRef.current = false;\n  };\n\n  useDrag(panelRef, {\n    start: (coordinate: Coordinate) => {\n      // pop 模式下由于是隐藏显示，这个宽度让其每次点击的时候重新计算\n      panelRectRef.current.width = panelRef.current.offsetWidth;\n      isMovedRef.current = false;\n      handleDrag(coordinate);\n    },\n    end: (coordinate: Coordinate) => {\n      handleDragEnd(coordinate);\n    },\n    drag: (coordinate: Coordinate) => {\n      handleDrag(coordinate);\n    },\n  });\n\n  useEffect(() => {\n    panelRectRef.current.width = panelRef.current.offsetWidth || SLIDER_DEFAULT_WIDTH;\n  }, []);\n\n  const paddingStyle = {\n    background: `linear-gradient(90deg, rgba(0,0,0,.0) 0%, rgba(0,0,0,.0) 93%, ${props.color.rgb} 93%, ${props.color.rgb} 100%)`,\n  };\n\n  return (\n    <div className={classnames(`${baseClassName}__slider-wrapper`, `${baseClassName}__slider-wrapper--${type}-type`)}>\n      {type === 'alpha' && <div className={`${baseClassName}__slider-padding`} style={paddingStyle} />}\n      <div className={classnames(`${baseClassName}__slider`, className)} ref={panelRef}>\n        <div className={`${baseClassName}__rail`} style={railStyle}></div>\n        <span className={`${baseClassName}__thumb`} role=\"slider\" tabIndex={0} ref={thumbRef} style={styles}></span>\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(ColorSlider);\n"],"names":["ColorSlider","props","color","_props$className","className","_props$value","value","_props$railStyle","railStyle","_props$maxValue","maxValue","baseClassName","disabled","onChange","type","panelRef","useRef","thumbRef","isMovedRef","panelRectRef","width","SLIDER_DEFAULT_WIDTH","_useStyles","useStyles","styles","handleDrag","coordinate","isEnded","current","x","Math","round","Number","handleDragEnd","useDrag","start","offsetWidth","end","drag","useEffect","paddingStyle","background","rgb","concat","React","createElement","classnames","style","ref","role","tabIndex","memo"],"mappings":"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"}