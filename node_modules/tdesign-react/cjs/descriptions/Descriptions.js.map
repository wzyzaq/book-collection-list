{"version":3,"file":"Descriptions.js","sources":["../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/assign.js","../../../components/descriptions/Descriptions.tsx"],"sourcesContent":["import assignValue from './_assignValue.js';\nimport copyObject from './_copyObject.js';\nimport createAssigner from './_createAssigner.js';\nimport isArrayLike from './isArrayLike.js';\nimport isPrototype from './_isPrototype.js';\nimport keys from './keys.js';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nexport default assign;\n","import React from 'react';\nimport classNames from 'classnames';\nimport { isArray, assign } from 'lodash-es';\nimport { TdDescriptionsItemProps, TdDescriptionsProps } from './type';\nimport { descriptionsItemDefaultProps, descriptionsDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\nimport useConfig from '../hooks/useConfig';\nimport useCommonClassName from '../hooks/useCommonClassName';\nimport { StyledProps } from '../common';\nimport { DescriptionsContext } from './DescriptionsContext';\nimport DescriptionsItem from './DescriptionsItem';\nimport Row from './Row';\n\nimport type { DescriptionsItemProps } from './DescriptionsItem';\n\n/**\n * 实现思路\n * 1. 基于 table tbody tr td 来实现布局\n * 2. 通过 span 计算总共有几行以及每一行的 item 个数，特别注意最后一行，要填充满\n * 3. 整体布局：左右布局（column 和 span 生效）/上下布局（column 和 span 失效，一行一个 item）\n * 4. item 布局：左右布局/上下布局\n */\n\n/**\n * TDescriptions：承载 header（title） 和 body（table, tbody）\n * TDescriptionsRow：承载每一行（tr）\n * TDescriptionsItem：获取 item 数据（span, label, content）\n */\n\nexport type DescriptionsProps = TdDescriptionsProps &\n  StyledProps & {\n    children?: React.ReactNode;\n  };\n\nconst Descriptions = (DescriptionsProps: DescriptionsProps) => {\n  const props = useDefaultProps<DescriptionsProps>(DescriptionsProps, descriptionsDefaultProps);\n\n  const { className, style, title, bordered, column, layout, items: rowItems, children, tableLayout } = props;\n\n  const { classPrefix } = useConfig();\n\n  const COMPONENT_NAME = `${classPrefix}-descriptions`;\n\n  const { SIZE } = useCommonClassName();\n\n  // 计算渲染的行内容\n  const getRows = () => {\n    // 1. 两种方式：a. props 传 items b. slots t-descriptions-item; a 优先级更高\n\n    let items: TdDescriptionsItemProps[] = [];\n\n    if (isArray(rowItems)) {\n      /**\n       * 2.1 a 方式获取 items\n       * ! 这里要支持 label: string / <div></div> / () =>  <div></div>\n       * ! 暂时没有这样一个全局的方法，所以先在组件内部写一个临时方法，无论之后是有了更好的处理方式要删除掉，还是其它组件也需要时再放到公共方法里面，都是可行的\n       */\n      items = rowItems.map((item) => {\n        const { span } = assign({}, descriptionsItemDefaultProps, item);\n        return {\n          label: item.label,\n          content: item.content,\n          span,\n        };\n      });\n    } else {\n      // 2.2 b 方式 获取 TDescriptionsItem\n      const childrenList = React.Children.toArray(children).filter(\n        (child: React.ReactElement<DescriptionsItemProps>) =>\n          (child.type as any)?.displayName === DescriptionsItem.displayName,\n      );\n\n      if (childrenList.length !== 0) {\n        items = (childrenList as React.ReactElement[]).map(\n          ({\n            props: child,\n          }: {\n            props: TdDescriptionsItemProps & {\n              children?: React.ReactNode;\n            };\n          }) => {\n            const { span } = assign({}, descriptionsItemDefaultProps, child);\n\n            return {\n              label: child.label,\n              content: child.content ?? child.children,\n              span,\n            };\n          },\n        );\n      }\n    }\n\n    // 2. 判断布局，如果整体布局为 'vertical'，那么直接返回即可。\n    if (layout === 'vertical') {\n      return [items];\n    }\n    // 3. 布局为 horizontal 时，需要计算每一行的 item 个数\n    let temp: TdDescriptionsItemProps[] = [];\n    let reset = column;\n    // 4. 记录结果\n    const res: TdDescriptionsItemProps[][] = [];\n    items.forEach((item, index) => {\n      const { span } = item;\n      if (reset >= span) {\n        // 当前行还剩余空间\n        temp.push(item);\n        reset -= span;\n      } else {\n        // 当前行放不下了，放下一行\n        res.push(temp);\n        temp = [item];\n        reset = column - span;\n      }\n\n      if (index === items.length - 1) {\n        // 最后一个\n        Reflect.set(item, 'span', span + reset);\n        res.push(temp);\n      }\n    });\n\n    return res;\n  };\n\n  // Header\n  const renderHeader = () => (title ? <div className={`${COMPONENT_NAME}__header`}>{title}</div> : '');\n\n  // Body\n  const renderBody = () => {\n    const tableClass = [\n      `${COMPONENT_NAME}__body`,\n      SIZE[props.size],\n      { [`${COMPONENT_NAME}__body--fixed`]: tableLayout === 'fixed' },\n      { [`${COMPONENT_NAME}__body--border`]: bordered },\n    ];\n    return (\n      <table className={classNames(tableClass)}>\n        <tbody>\n          {getRows().map((row, i) => (\n            <Row row={row} key={i} />\n          ))}\n        </tbody>\n      </table>\n    );\n  };\n\n  return (\n    <DescriptionsContext.Provider value={props}>\n      <div className={classNames(className, COMPONENT_NAME)} style={style}>\n        {renderHeader()}\n        {renderBody()}\n      </div>\n    </DescriptionsContext.Provider>\n  );\n};\n\nDescriptions.displayName = 'Descriptions';\n\nDescriptions.DescriptionsItem = DescriptionsItem;\n\nexport default Descriptions;\n"],"names":["objectProto","Object","prototype","hasOwnProperty","assign","createAssigner","object","source","isPrototype","isArrayLike","copyObject","keys","key","call","assignValue","Descriptions","DescriptionsProps","props","useDefaultProps","descriptionsDefaultProps","className","style","title","bordered","column","layout","rowItems","items","children","tableLayout","_useConfig","useConfig","classPrefix","COMPONENT_NAME","_useCommonClassName","useCommonClassName","SIZE","getRows","isArray","map","item","_assign","descriptionsItemDefaultProps","span","label","content","childrenList","React","Children","toArray","filter","child","_child$type","type","displayName","DescriptionsItem","length","_ref","_child$content","_assign2","temp","reset","res","forEach","index","push","Reflect","set","renderHeader","createElement","renderBody","tableClass","concat","size","_defineProperty","classNames","row","i","Row","DescriptionsContext","Provider","value"],"mappings":"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"}