{"version":3,"file":"Tooltip.js","sources":["../../../components/tooltip/Tooltip.tsx"],"sourcesContent":["import React, { forwardRef, useState, useEffect, useRef, useImperativeHandle } from 'react';\nimport classNames from 'classnames';\nimport Popup, { PopupRef, PopupVisibleChangeContext } from '../popup';\nimport useConfig from '../hooks/useConfig';\nimport { TdTooltipProps } from './type';\nimport { tooltipDefaultProps } from './defaultProps';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\nexport type TooltipProps = TdTooltipProps;\n\nconst Tooltip = forwardRef<Partial<PopupRef>, TdTooltipProps>((originalProps, ref) => {\n  const props = useDefaultProps<TdTooltipProps>(originalProps, tooltipDefaultProps);\n  const {\n    theme,\n    showArrow,\n    destroyOnClose,\n    overlayClassName,\n    children,\n    duration,\n    placement,\n    onVisibleChange,\n    ...restProps\n  } = props;\n\n  const { classPrefix } = useConfig();\n  const [timeUp, setTimeUp] = useState(false);\n  const popupRef = useRef<PopupRef>(null);\n  const timerRef = useRef<number | null>(null);\n  const toolTipClass = classNames(\n    `${classPrefix}-tooltip`,\n    {\n      [`${classPrefix}-tooltip--${theme}`]: theme,\n    },\n    overlayClassName,\n  );\n\n  function handleVisibleChange(visible: boolean, { e, trigger }: PopupVisibleChangeContext) {\n    setTimeUp(false);\n    onVisibleChange?.(visible, { e, trigger });\n  }\n\n  useEffect(() => {\n    if (duration !== 0 && !timeUp) {\n      popupRef.current?.setVisible?.(true);\n      timerRef.current = window.setTimeout(() => {\n        popupRef.current?.setVisible?.(false);\n        setTimeUp(true);\n      }, duration);\n    }\n    return () => {\n      window.clearTimeout(timerRef.current);\n    };\n  }, [duration, timeUp]);\n\n  useImperativeHandle(ref, () => ({\n    ...(popupRef.current || {}),\n  }));\n\n  return (\n    <Popup\n      ref={popupRef}\n      destroyOnClose={destroyOnClose}\n      showArrow={showArrow}\n      overlayClassName={toolTipClass}\n      onVisibleChange={handleVisibleChange}\n      placement={placement}\n      {...restProps}\n    >\n      {children}\n    </Popup>\n  );\n});\n\nTooltip.displayName = 'Tooltip';\n\nexport default Tooltip;\n"],"names":["Tooltip","forwardRef","originalProps","ref","props","useDefaultProps","tooltipDefaultProps","theme","showArrow","destroyOnClose","overlayClassName","children","duration","placement","onVisibleChange","restProps","_objectWithoutProperties","_excluded","_useConfig","useConfig","classPrefix","_useState","useState","_useState2","_slicedToArray","timeUp","setTimeUp","popupRef","useRef","timerRef","toolTipClass","classNames","concat","_defineProperty","handleVisibleChange","visible","_ref","e","trigger","useEffect","_popupRef$current","_popupRef$current$set","current","setVisible","call","window","setTimeout","_popupRef$current2","_popupRef$current2$se","clearTimeout","useImperativeHandle","_objectSpread","React","createElement","Popup","displayName"],"mappings":"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"}