{"version":3,"file":"useKeyboard.js","sources":["../../../components/radio/useKeyboard.ts"],"sourcesContent":["import { MutableRefObject, useEffect, ChangeEvent, KeyboardEvent } from 'react';\nimport { CHECKED_CODE_REG } from '@tdesign/common-js/common';\nimport { off, on } from '../_util/dom';\n\n/** 键盘操作 */\nexport default function useKeyboard(\n  radioGroupRef: MutableRefObject<HTMLDivElement>,\n  setInnerValue: (value: any, context: { e: ChangeEvent<any> }) => void,\n) {\n  const checkRadioInGroup = (e: KeyboardEvent) => {\n    if (CHECKED_CODE_REG.test(e.key) || CHECKED_CODE_REG.test(e.code)) {\n      const inputNode = (e.target as HTMLElement).querySelector('input');\n      const data = inputNode?.dataset || {};\n      if (inputNode.checked && data.allowUncheck) {\n        setInnerValue(undefined, { e });\n      } else {\n        // Number\n        let value: number | string | boolean = !isNaN(Number(data.value)) ? Number(data.value) : data.value;\n        // Boolean\n        value = (typeof value === 'string' && { true: true, false: false }[value]) || value;\n        // String\n        value = typeof value === 'string' && value[0] === \"'\" ? value.replace(/'/g, '') : value;\n        setInnerValue(value, { e });\n      }\n    }\n  };\n\n  useEffect(() => {\n    on(radioGroupRef.current, 'keydown', checkRadioInGroup);\n    return () => {\n      // eslint-disable-next-line react-hooks/exhaustive-deps\n      off(radioGroupRef.current, 'keydown', checkRadioInGroup);\n    };\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n}\n"],"names":["useKeyboard","radioGroupRef","setInnerValue","checkRadioInGroup","e","CHECKED_CODE_REG","test","key","code","inputNode","target","querySelector","data","dataset","checked","allowUncheck","value","isNaN","Number","replace","useEffect","on","current","off"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAKwB,SAAAA,WAAAA,CACtBC,eACAC,aACA,EAAA;AACM,EAAA,IAAAC,iBAAA,GAAoB,SAApBA,iBAAAA,CAAqBC,CAAqB,EAAA;AAC1C,IAAA,IAAAC,uBAAA,CAAiBC,KAAKF,CAAE,CAAAG,GAAG,KAAKF,uBAAiB,CAAAC,IAAA,CAAKF,CAAE,CAAAI,IAAI,CAAG,EAAA;MACjE,IAAMC,SAAa,GAAAL,CAAA,CAAEM,MAAuB,CAAAC,aAAA,CAAc,OAAO,CAAA,CAAA;AAC3D,MAAA,IAAAC,IAAA,GAAO,CAAAH,SAAW,KAAXA,IAAAA,IAAAA,SAAW,KAAXA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,SAAW,CAAAI,OAAA,KAAW,EAAC,CAAA;AAChC,MAAA,IAAAJ,SAAA,CAAUK,OAAW,IAAAF,IAAA,CAAKG,YAAc,EAAA;QAC5Bb,aAAA,CAAA,KAAA,CAAA,EAAW;AAAEE,UAAAA,CAAA,EAAAA,CAAAA;AAAE,SAAC,CAAA,CAAA;AAChC,OAAO,MAAA;QAEL,IAAIY,KAAmC,GAAA,CAACC,KAAM,CAAAC,MAAA,CAAON,IAAK,CAAAI,KAAK,CAAC,CAAA,GAAIE,MAAO,CAAAN,IAAA,CAAKI,KAAK,CAAA,GAAIJ,IAAK,CAAAI,KAAA,CAAA;AAErFA,QAAAA,KAAA,GAAA,OAAOA,UAAU,QAAY,IAAA;AAAE,UAAA,MAAA,EAAM,IAAM;UAAA,OAAO,EAAA,KAAA;AAAM,SAAA,CAAEA,KAAW,CAAA,IAAAA,KAAA,CAAA;QAEtEA,KAAA,GAAA,OAAOA,KAAU,KAAA,QAAA,IAAYA,KAAM,CAAA,CAAA,CAAA,KAAO,MAAMA,KAAM,CAAAG,OAAA,CAAQ,IAAM,EAAA,EAAE,CAAI,GAAAH,KAAA,CAAA;QACpEd,aAAA,CAAAc,KAAA,EAAO;AAAEZ,UAAAA,CAAA,EAAAA,CAAAA;AAAE,SAAC,CAAA,CAAA;AAC5B,OAAA;AACF,KAAA;GACF,CAAA;AAEAgB,EAAAA,eAAA,CAAU,YAAM;IACXC,YAAA,CAAApB,aAAA,CAAcqB,OAAS,EAAA,SAAA,EAAWnB,iBAAiB,CAAA,CAAA;AACtD,IAAA,OAAO,YAAM;MAEPoB,aAAA,CAAAtB,aAAA,CAAcqB,OAAS,EAAA,SAAA,EAAWnB,iBAAiB,CAAA,CAAA;KACzD,CAAA;GAEF,EAAG,EAAE,CAAA,CAAA;AACP;;;;"}