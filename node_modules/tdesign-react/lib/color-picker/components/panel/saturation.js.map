{"version":3,"file":"saturation.js","sources":["../../../../../components/color-picker/components/panel/saturation.tsx"],"sourcesContent":["import React, { useRef, useEffect, useCallback } from 'react';\nimport {\n  SATURATION_PANEL_DEFAULT_HEIGHT,\n  SATURATION_PANEL_DEFAULT_WIDTH,\n} from '@tdesign/common-js/color-picker/constants';\nimport { TdColorBaseProps } from '../../interface';\nimport useDrag, { Coordinate } from '../../../hooks/useDrag';\n\nconst Saturation = (props: TdColorBaseProps) => {\n  const { color, disabled, onChange, baseClassName } = props;\n  const panelRef = useRef<HTMLDivElement>(null);\n  const thumbRef = useRef<HTMLElement>(null);\n  const panelRectRef = useRef({\n    width: SATURATION_PANEL_DEFAULT_WIDTH,\n    height: SATURATION_PANEL_DEFAULT_HEIGHT,\n  });\n\n  const styles = () => {\n    const { saturation, value, rgb } = color;\n    const { width, height } = panelRectRef.current;\n    const top = Math.round((1 - value) * height);\n    const left = Math.round(saturation * width);\n    return {\n      color: rgb,\n      left: `${left}px`,\n      top: `${top}px`,\n    };\n  };\n\n  const getSaturationAndValueByCoordinate = (coordinate: Coordinate) => {\n    const { width, height } = panelRectRef.current;\n    const { x, y } = coordinate;\n    const saturation = Math.round((x / width) * 100);\n    const value = Math.round((1 - y / height) * 100);\n    return {\n      saturation,\n      value,\n    };\n  };\n\n  const isDragging = useRef<Boolean>(false);\n\n  const handleDrag = useCallback(\n    ({ x, y }: Coordinate, isEnd?: boolean) => {\n      if (disabled) {\n        return;\n      }\n      isDragging.current = true;\n      const { saturation, value } = getSaturationAndValueByCoordinate({ x, y });\n      onChange({\n        saturation: saturation / 100,\n        value: value / 100,\n        addUsedColor: isEnd,\n      });\n    },\n    [disabled, onChange],\n  );\n\n  const handleDragEnd = useCallback((coordinate: Coordinate) => {\n    if (disabled) {\n      return;\n    }\n    isDragging.current = false;\n    handleDrag(coordinate, true);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  useDrag(panelRef, {\n    start: () => {\n      panelRectRef.current.width = panelRef.current.offsetWidth;\n      panelRectRef.current.height = panelRef.current.offsetHeight;\n    },\n    end: (coordinate: Coordinate) => {\n      handleDragEnd(coordinate);\n    },\n    drag: (coordinate: Coordinate) => {\n      handleDrag(coordinate);\n    },\n  });\n\n  useEffect(() => {\n    panelRectRef.current.width = panelRef.current.offsetWidth || SATURATION_PANEL_DEFAULT_WIDTH;\n    panelRectRef.current.height = panelRef.current.offsetHeight || SATURATION_PANEL_DEFAULT_HEIGHT;\n  }, [handleDrag, handleDragEnd]);\n\n  return (\n    <div\n      className={`${baseClassName}__saturation`}\n      ref={panelRef}\n      style={{\n        background: `hsl(${color.hue}, 100%, 50%)`,\n      }}\n    >\n      <span\n        className={`${baseClassName}__thumb`}\n        role=\"slider\"\n        tabIndex={0}\n        ref={thumbRef}\n        style={{ ...styles() }}\n      ></span>\n    </div>\n  );\n};\n\nexport default React.memo(Saturation);\n"],"names":["Saturation","props","color","disabled","onChange","baseClassName","panelRef","useRef","thumbRef","panelRectRef","width","SATURATION_PANEL_DEFAULT_WIDTH","height","SATURATION_PANEL_DEFAULT_HEIGHT","styles","saturation","value","rgb","_panelRectRef$current","current","top","Math","round","left","getSaturationAndValueByCoordinate","coordinate","_panelRectRef$current2","x","y","isDragging","handleDrag","useCallback","_ref","isEnd","_getSaturationAndValu","addUsedColor","handleDragEnd","useDrag","start","offsetWidth","offsetHeight","end","drag","useEffect","React","createElement","className","ref","style","background","concat","hue","role","tabIndex","_objectSpread","memo"],"mappings":"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"}