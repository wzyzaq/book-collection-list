{"version":3,"file":"TimelineItem.js","sources":["../../../components/timeline/TimelineItem.tsx"],"sourcesContent":["import React, { useContext, useMemo } from 'react';\nimport classNames from 'classnames';\nimport { omit } from 'lodash-es';\nimport { TdTimelineItemProps } from './type';\nimport { StyledProps } from '../common';\nimport useConfig from '../hooks/useConfig';\nimport TimelineContext from './TimelineContext';\nimport parseTNode from '../_util/parseTNode';\nimport { useAlign } from './useAlign';\nimport Loading from '../loading';\n\nexport interface TimelineItemProps extends TdTimelineItemProps, StyledProps {\n  children?: React.ReactNode;\n  index?: number;\n  onClick?: (context: { e: React.MouseEvent<HTMLElement>; item: TdTimelineItemProps }) => void;\n}\n\nconst DefaultTheme = ['default', 'primary', 'success', 'warning', 'error'];\n\nconst TimelineItem: React.FC<TimelineItemProps> = (props) => {\n  const {\n    className,\n    style = {},\n    dot,\n    dotColor = 'primary',\n    labelAlign,\n    children,\n    index,\n    content,\n    label,\n    loading = false,\n    onClick,\n  } = props;\n  const { theme, reverse, itemsStatus, layout, globalAlign, mode } = useContext(TimelineContext);\n  const { classPrefix } = useConfig();\n  const renderAlign = useAlign(globalAlign, layout);\n\n  // 计算节点模式 CSS 类名\n  const getPositionClassName = (index: number) => {\n    // 横向布局 以及 纵向布局对应为不同的样式名\n    const left = layout === 'horizontal' ? 'top' : 'left';\n    const right = layout === 'horizontal' ? 'bottom' : 'right';\n    // 单独设置则单独生效\n    if (renderAlign === 'alternate') {\n      return labelAlign || index % 2 === 0\n        ? `${classPrefix}-timeline-item-${left}`\n        : `${classPrefix}-timeline-item-${right}`;\n    }\n    if (renderAlign === 'left' || renderAlign === 'top') {\n      return `${classPrefix}-timeline-item-${left}`;\n    }\n    if (renderAlign === 'right' || renderAlign === 'bottom') {\n      return `${classPrefix}-timeline-item-${right}`;\n    }\n    return '';\n  };\n\n  const dotElement = useMemo(() => {\n    const ele = parseTNode(dot);\n\n    if (React.isValidElement(ele)) {\n      return React.cloneElement<any>(ele, {\n        className: classNames((ele as any)?.props?.className, `${classPrefix}-timeline-item__dot-content`),\n      });\n    }\n    return ele;\n  }, [dot, classPrefix]);\n\n  const handleClick = (e: React.MouseEvent<HTMLElement>) => {\n    onClick?.({ e, item: omit(props, ['children', 'index', 'onClick']) });\n  };\n\n  // 节点类名\n  const itemClassName = classNames(\n    {\n      [`${classPrefix}-timeline-item`]: true,\n      [`${getPositionClassName(index)}`]: true,\n    },\n    className,\n  );\n\n  // 连线类名\n  const tailClassName = classNames({\n    [`${classPrefix}-timeline-item__tail`]: true,\n    [`${classPrefix}-timeline-item__tail--theme-${theme}`]: true,\n    [`${classPrefix}-timeline-item__tail--status-${itemsStatus[index]}`]: reverse,\n  });\n\n  // 圆圈类名\n  const dotClassName = classNames({\n    [`${classPrefix}-timeline-item__dot`]: true,\n    [`${classPrefix}-timeline-item__dot--custom`]: !!dotElement || (!dotElement && loading),\n    [`${classPrefix}-timeline-item__dot--${dotColor}`]: DefaultTheme.includes(dotColor),\n  });\n\n  const labelClassName = classNames(`${classPrefix}-timeline-item__label`, {\n    [`${classPrefix}-timeline-item__label--${mode}`]: true,\n  });\n\n  return (\n    <li className={itemClassName} style={style} onClick={handleClick}>\n      {mode === 'alternate' && label && <div className={labelClassName}>{label}</div>}\n      <div className={`${classPrefix}-timeline-item__wrapper`}>\n        <div className={dotClassName} style={{ borderColor: !DefaultTheme.includes(dotColor) && dotColor }}>\n          {!dotElement && loading && <Loading size=\"12px\" className={`${classPrefix}-timeline-item__dot-content`} />}\n          {dotElement}\n        </div>\n        <div className={tailClassName} />\n      </div>\n      <div className={`${classPrefix}-timeline-item__content`}>\n        {content || children}\n        {mode === 'same' && label && <div className={labelClassName}>{label}</div>}\n      </div>\n    </li>\n  );\n};\n\nTimelineItem.displayName = 'TimelineItem';\n\nexport default TimelineItem;\n"],"names":["DefaultTheme","TimelineItem","props","className","_props$style","style","dot","_props$dotColor","dotColor","labelAlign","children","index","content","label","_props$loading","loading","onClick","_useContext","useContext","TimelineContext","theme","reverse","itemsStatus","layout","globalAlign","mode","_useConfig","useConfig","classPrefix","renderAlign","useAlign","getPositionClassName","left","right","concat","dotElement","useMemo","ele","parseTNode","React","isValidElement","_ele$props","cloneElement","classNames","handleClick","e","item","omit","itemClassName","_defineProperty","tailClassName","dotClassName","includes","labelClassName","createElement","borderColor","Loading","size","displayName"],"mappings":"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"}