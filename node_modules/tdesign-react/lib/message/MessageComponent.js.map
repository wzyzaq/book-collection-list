{"version":3,"file":"MessageComponent.js","sources":["../../../components/message/MessageComponent.tsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport classNames from 'classnames';\nimport { TdMessageProps } from './type';\n\n// 依赖组件引入\nimport MessageClose from './MessageClose';\nimport MessageIcon from './MessageIcon';\nimport { useMessageClass } from './useMessageClass';\nimport { StyledProps } from '../common';\nimport { usePersistFn } from '../hooks/usePersistFn';\nimport noop from '../_util/noop';\n\n// Message 组件参数，需在 api 定义上做部分扩展\nexport interface MessageComponentProps extends TdMessageProps, StyledProps {\n  children?: React.ReactNode;\n}\n\n// message 直接作为组件使用时\nconst MessageComponent: React.FC<MessageComponentProps> = (props) => {\n  // 样式相关变量和函数\n  const { tdMessagePrefix, tdClassIsGenerator } = useMessageClass();\n\n  const {\n    theme = 'info',\n    className,\n    children,\n    style,\n    icon = true,\n    content,\n    closeBtn,\n    onCloseBtnClick = noop,\n    onDurationEnd = noop,\n    onClose = noop,\n    duration,\n  } = props;\n\n  const [isHovering, setIsHovering] = useState(false);\n  const onCloseFn = usePersistFn(onClose);\n  const onDurationEndFn = usePersistFn(onDurationEnd);\n  const onCloseBtnClickFn = usePersistFn(onCloseBtnClick);\n\n  function handleCloseBtnClick(e) {\n    onCloseBtnClickFn(e);\n    onCloseFn({\n      trigger: 'close-click',\n    });\n  }\n\n  useEffect(() => {\n    if (!isHovering && duration > 0) {\n      const timer = setTimeout(() => {\n        onDurationEndFn();\n        onCloseFn({\n          trigger: 'duration-end',\n        });\n      }, duration);\n      return () => {\n        clearTimeout(timer);\n      };\n    }\n  }, [duration, isHovering, onCloseFn, onDurationEndFn]);\n\n  return (\n    <div\n      key=\"message\"\n      style={style}\n      className={classNames(\n        className,\n        `${tdMessagePrefix}`,\n        tdClassIsGenerator(theme),\n        closeBtn ? tdClassIsGenerator('closable') : '',\n      )}\n      onMouseEnter={() => setIsHovering(true)}\n      onMouseLeave={() => setIsHovering(false)}\n    >\n      {icon === true ? <MessageIcon theme={theme} /> : icon}\n      {content ? content : children}\n      <MessageClose closeBtn={closeBtn} onCloseBtnClick={handleCloseBtnClick} />\n    </div>\n  );\n};\n\nexport default MessageComponent;\n"],"names":["MessageComponent","props","_useMessageClass","useMessageClass","tdMessagePrefix","tdClassIsGenerator","_props$theme","theme","className","children","style","_props$icon","icon","content","closeBtn","_props$onCloseBtnClic","onCloseBtnClick","noop","_props$onDurationEnd","onDurationEnd","_props$onClose","onClose","duration","_useState","useState","_useState2","_slicedToArray","isHovering","setIsHovering","onCloseFn","usePersistFn","onDurationEndFn","onCloseBtnClickFn","handleCloseBtnClick","e","trigger","useEffect","timer","setTimeout","clearTimeout","React","createElement","key","classNames","concat","onMouseEnter","onMouseLeave","MessageIcon","MessageClose"],"mappings":"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"}