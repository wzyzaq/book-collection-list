{"version":3,"file":"Alert.js","sources":["../../../components/alert/Alert.tsx"],"sourcesContent":["import React, { forwardRef, useRef } from 'react';\nimport classNames from 'classnames';\nimport {\n  CloseIcon as TdCloseIcon,\n  InfoCircleFilledIcon as TdInfoCircleFilledIcon,\n  CheckCircleFilledIcon as TdCheckCircleFilledIcon,\n  ErrorCircleFilledIcon as TdErrorCircleFilledIcon,\n} from 'tdesign-icons-react';\nimport { CSSTransition } from 'react-transition-group';\nimport noop from '../_util/noop';\nimport parseTNode from '../_util/parseTNode';\nimport useConfig from '../hooks/useConfig';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport { useLocaleReceiver } from '../locale/LocalReceiver';\nimport { TdAlertProps } from './type';\nimport { StyledProps } from '../common';\nimport { alertDefaultProps } from './defaultProps';\nimport composeRefs from '../_util/composeRefs';\nimport useDefaultProps from '../hooks/useDefaultProps';\n\nconst transitionTime = 200;\n\nexport interface AlertProps extends TdAlertProps, StyledProps {}\n\nconst Alert = forwardRef<HTMLDivElement, AlertProps>((props, ref) => {\n  const { classPrefix } = useConfig();\n  const [local, t] = useLocaleReceiver('alert');\n  const { CloseIcon, InfoCircleFilledIcon, CheckCircleFilledIcon, ErrorCircleFilledIcon } = useGlobalIcon({\n    CloseIcon: TdCloseIcon,\n    InfoCircleFilledIcon: TdInfoCircleFilledIcon,\n    CheckCircleFilledIcon: TdCheckCircleFilledIcon,\n    ErrorCircleFilledIcon: TdErrorCircleFilledIcon,\n  });\n\n  const {\n    message,\n    title,\n    operation,\n    theme,\n    icon,\n    close,\n    maxLine,\n    onClose,\n    className,\n    onClosed = noop,\n    ...alertProps\n  } = useDefaultProps(props, alertDefaultProps);\n\n  const [closed, setClosed] = React.useState(false);\n  const [collapsed, setCollapsed] = React.useState(true);\n  const nodeRef = useRef<HTMLDivElement>(null);\n\n  const iconMap = {\n    success: CheckCircleFilledIcon,\n    info: InfoCircleFilledIcon,\n    error: ErrorCircleFilledIcon,\n    warning: ErrorCircleFilledIcon,\n  };\n\n  const handleClose = (e: React.MouseEvent<HTMLDivElement>) => {\n    setClosed(true);\n    onClose?.({ e });\n  };\n\n  const handleCollapse = () => {\n    setCollapsed((collapsed) => !collapsed);\n  };\n\n  const renderIconNode = () => {\n    if (React.isValidElement(icon)) return icon;\n    return React.createElement(iconMap[theme]);\n  };\n\n  const renderMessage = () => {\n    if (+maxLine > 0 && Array.isArray(message)) {\n      return (\n        <div className={`${classPrefix}-alert__description`}>\n          {message.map((item, index) => {\n            if (collapsed) {\n              if (index < +maxLine) {\n                return <div key={index}>{item}</div>;\n              }\n            } else {\n              return <div key={index}>{item}</div>;\n            }\n            return true;\n          })}\n          {+maxLine < message.length && (\n            <div className={`${classPrefix}-alert__collapse`} onClick={handleCollapse}>\n              {collapsed ? t(local.expandText) : t(local.collapseText)}\n            </div>\n          )}\n        </div>\n      );\n    }\n    return <div className={`${classPrefix}-alert__description`}>{message}</div>;\n  };\n\n  const renderClose = () => (\n    <div className={`${classPrefix}-alert__close`} onClick={handleClose}>\n      {typeof close === 'boolean' ? <CloseIcon /> : parseTNode(close)}\n    </div>\n  );\n\n  return (\n    <CSSTransition\n      in={!closed}\n      unmountOnExit\n      classNames={{\n        exitActive: `${classPrefix}-alert--closing`,\n      }}\n      nodeRef={nodeRef}\n      timeout={transitionTime}\n      onExited={onClosed}\n    >\n      <div\n        ref={composeRefs(ref, nodeRef)}\n        className={classNames(`${classPrefix}-alert`, `${classPrefix}-alert--${theme}`, className)}\n        {...alertProps}\n      >\n        <div className={`${classPrefix}-alert__icon`}>{renderIconNode()}</div>\n        <div className={`${classPrefix}-alert__content`}>\n          {title ? <div className={`${classPrefix}-alert__title`}>{title}</div> : null}\n          <div className={`${classPrefix}-alert__message`}>\n            {renderMessage()}\n            {operation ? <div className={`${classPrefix}-alert__operation`}>{parseTNode(operation)}</div> : null}\n          </div>\n        </div>\n        {close ? renderClose() : null}\n      </div>\n    </CSSTransition>\n  );\n});\n\nAlert.displayName = 'Alert';\n\nexport default Alert;\n"],"names":["transitionTime","Alert","forwardRef","props","ref","_useConfig","useConfig","classPrefix","_useLocaleReceiver","useLocaleReceiver","_useLocaleReceiver2","_slicedToArray","local","t","_useGlobalIcon","useGlobalIcon","CloseIcon","TdCloseIcon","InfoCircleFilledIcon","TdInfoCircleFilledIcon","CheckCircleFilledIcon","TdCheckCircleFilledIcon","ErrorCircleFilledIcon","TdErrorCircleFilledIcon","_useDefaultProps","useDefaultProps","alertDefaultProps","message","title","operation","theme","icon","close","maxLine","onClose","className","_useDefaultProps$onCl","onClosed","noop","alertProps","_objectWithoutProperties","_excluded","_React$useState","React","useState","_React$useState2","closed","setClosed","_React$useState3","_React$useState4","collapsed","setCollapsed","nodeRef","useRef","iconMap","success","info","error","warning","handleClose","e","handleCollapse","renderIconNode","isValidElement","createElement","renderMessage","Array","isArray","map","item","index","key","length","onClick","expandText","collapseText","renderClose","parseTNode","CSSTransition","unmountOnExit","classNames","exitActive","timeout","onExited","_objectSpread","composeRefs","concat","displayName"],"mappings":"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"}