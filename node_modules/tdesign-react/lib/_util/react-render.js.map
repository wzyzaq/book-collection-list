{"version":3,"file":"react-render.js","sources":["../../../components/_util/react-render.ts"],"sourcesContent":["// Implementation reference from: https://github.com/react-component/util/blob/master/src/React/render.ts\n// @ts-ignore\nimport type * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport { createRoot as createRootClient } from 'react-dom/client';\nimport type { Root } from 'react-dom/client';\n\n// Let compiler not to search module usage\nconst fullClone = {\n  ...ReactDOM,\n} as typeof ReactDOM & {\n  __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED?: {\n    usingClientEntryPoint?: boolean;\n  };\n  createRoot?: CreateRoot;\n};\n\ntype CreateRoot = (container: ContainerType) => Root;\n\n// @ts-ignore\nconst { version, render: reactRender, unmountComponentAtNode } = fullClone;\n\nlet createRoot: CreateRoot;\ntry {\n  const mainVersion = Number((version || '').split('.')[0]);\n  if (mainVersion >= 18 && mainVersion < 19) {\n    ({ createRoot } = fullClone);\n  } else if (mainVersion >= 19) {\n    createRoot = createRootClient;\n  }\n} catch (e) {\n  // Do nothing;\n}\n\nfunction toggleWarning(skip: boolean) {\n  const { __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED } = fullClone;\n\n  if (\n    __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED &&\n    typeof __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED === 'object'\n  ) {\n    __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.usingClientEntryPoint = skip;\n  }\n}\n\nconst MARK = '__td_react_root__';\n\n// ========================== Render ==========================\ntype ContainerType = (Element | DocumentFragment) & {\n  [MARK]?: Root;\n};\n\nfunction modernRender(node: React.ReactElement, container: ContainerType) {\n  toggleWarning(true);\n  const root = container[MARK] || createRoot(container);\n  toggleWarning(false);\n\n  root.render(node);\n\n  // eslint-disable-next-line\n  container[MARK] = root;\n}\n\nfunction legacyRender(node: React.ReactElement, container: ContainerType) {\n  reactRender(node, container);\n}\n\nexport function render(node: React.ReactElement, container: ContainerType) {\n  if (createRoot) {\n    modernRender(node, container);\n    return;\n  }\n\n  legacyRender?.(node, container);\n}\n\n// ========================= Unmount ==========================\nasync function modernUnmount(container: ContainerType) {\n  // Delay to unmount to avoid React 18 sync warning\n  return Promise.resolve().then(() => {\n    container[MARK]?.unmount();\n\n    // eslint-disable-next-line\n    delete container[MARK];\n  });\n}\n\nfunction legacyUnmount(container: ContainerType) {\n  unmountComponentAtNode(container);\n}\n\nexport async function unmount(container: ContainerType) {\n  if (createRoot !== undefined) {\n    // Delay to unmount to avoid React 18 sync warning\n    return modernUnmount(container);\n  }\n\n  legacyUnmount(container);\n}\n"],"names":["fullClone","_objectSpread","ReactDOM","version","reactRender","render","unmountComponentAtNode","createRoot","mainVersion","Number","split","createRootClient","e","toggleWarning","skip","__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED","_typeof","usingClientEntryPoint","MARK","modernRender","node","container","root","legacyRender","modernUnmount","_callee","_regeneratorRuntime","wrap","_callee$","_context","prev","next","abrupt","Promise","resolve","then","_container$MARK","unmount","stop","_modernUnmount","apply","arguments","legacyUnmount","_unmount","_asyncToGenerator","mark","_callee2","_callee2$","_context2"],"mappings":"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"}