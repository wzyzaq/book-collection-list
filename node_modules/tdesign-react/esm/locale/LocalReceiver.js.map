{"version":3,"file":"LocalReceiver.js","sources":["../../../components/locale/LocalReceiver.ts"],"sourcesContent":["import React from 'react';\nimport { ConfigContext, Locale } from '../config-provider';\n\nexport interface Placement {\n  [propName: string]: string | number;\n}\n\nexport type TransformPattern = string | Function | Array<string>;\n\nexport function useLocaleReceiver<T extends keyof Locale>(componentName: T, defaultLocale?: Locale[T] | Function) {\n  const { globalConfig } = React.useContext(ConfigContext);\n\n  function transformLocale(pattern: TransformPattern, placement?: Placement): string | Array<string> {\n    const REGEXP = /\\{\\s*([\\w-]+)\\s*\\}/g;\n    if (typeof pattern === 'string') {\n      if (!placement || !REGEXP.test(pattern)) return pattern;\n      const translated = pattern.replace(REGEXP, (_, key) => {\n        if (placement) return String(placement[key]);\n        return '';\n      });\n      return translated;\n    }\n    if (Array.isArray(pattern)) {\n      return pattern.map((p, index) => {\n        const translated = p.replace(REGEXP, (_: string, key: string) => {\n          if (placement) return String(placement[index][key]);\n          return '';\n        });\n        return translated;\n      });\n    }\n    if (typeof pattern === 'function') {\n      return pattern(placement);\n    }\n    return '';\n  }\n\n  /** @TypeA => 确保此参数是属于 globalConfig[componentName] 下的子属性 */\n  const componentLocale = React.useMemo<Locale[T] | Function>(() => {\n    const locale = defaultLocale || {};\n    const connectLocaleByName = globalConfig[componentName];\n\n    const localeFromContext = componentName && globalConfig ? connectLocaleByName : {};\n\n    return {\n      ...(typeof locale === 'function' ? (locale as Function)() : locale),\n      ...(localeFromContext || {}),\n    };\n  }, [componentName, defaultLocale, globalConfig]);\n\n  return [componentLocale, transformLocale] as [Locale[T], Function];\n}\n"],"names":["useLocaleReceiver","componentName","defaultLocale","_React$useContext","React","useContext","ConfigContext","globalConfig","transformLocale","pattern","placement","REGEXP","test","translated","replace","_","key","String","Array","isArray","map","p","index","componentLocale","useMemo","locale","connectLocaleByName","localeFromContext","_objectSpread"],"mappings":";;;;;;;;;;;;;;;;;;;;;AASgB,SAAAA,iBAAAA,CAA0CC,eAAkBC,aAAsC,EAAA;AAChH,EAAA,IAAAC,iBAAA,GAAyBC,KAAA,CAAMC,WAAWC,aAAa,CAAA;IAA/CC,YAAA,GAAAJ,iBAAA,CAAAI,YAAA,CAAA;AAEC,EAAA,SAAAC,eAAAA,CAAgBC,SAA2BC,SAA+C,EAAA;IACjG,IAAMC,MAAS,GAAA,qBAAA,CAAA;AACX,IAAA,IAAA,OAAOF,YAAY,QAAU,EAAA;AAC/B,MAAA,IAAI,CAACC,SAAA,IAAa,CAACC,MAAA,CAAOC,KAAKH,OAAO,CAAA,EAAU,OAAAA,OAAA,CAAA;AAChD,MAAA,IAAMI,aAAaJ,OAAQ,CAAAK,OAAA,CAAQH,MAAQ,EAAA,UAACI,GAAGC,GAAQ,EAAA;QACjD,IAAAN,SAAA,EAAkB,OAAAO,MAAA,CAAOP,UAAUM,GAAI,CAAA,CAAA,CAAA;AACpC,QAAA,OAAA,EAAA,CAAA;AACT,OAAC,CAAA,CAAA;AACM,MAAA,OAAAH,UAAA,CAAA;AACT,KAAA;AACI,IAAA,IAAAK,KAAA,CAAMC,OAAQ,CAAAV,OAAO,CAAG,EAAA;MAC1B,OAAOA,OAAQ,CAAAW,GAAA,CAAI,UAACC,CAAA,EAAGC,KAAU,EAAA;AAC/B,QAAA,IAAMT,aAAaQ,CAAE,CAAAP,OAAA,CAAQH,MAAQ,EAAA,UAACI,GAAWC,GAAgB,EAAA;AAC3D,UAAA,IAAAN,SAAA,EAAkB,OAAAO,MAAA,CAAOP,SAAU,CAAAY,KAAA,CAAA,CAAON,GAAI,CAAA,CAAA,CAAA;AAC3C,UAAA,OAAA,EAAA,CAAA;AACT,SAAC,CAAA,CAAA;AACM,QAAA,OAAAH,UAAA,CAAA;AACT,OAAC,CAAA,CAAA;AACH,KAAA;AACI,IAAA,IAAA,OAAOJ,YAAY,UAAY,EAAA;MACjC,OAAOA,QAAQC,SAAS,CAAA,CAAA;AAC1B,KAAA;AACO,IAAA,OAAA,EAAA,CAAA;AACT,GAAA;AAGM,EAAA,IAAAa,eAAA,GAAkBnB,KAAM,CAAAoB,OAAA,CAA8B,YAAM;AAC1D,IAAA,IAAAC,MAAA,GAASvB,iBAAiB,EAAC,CAAA;AACjC,IAAA,IAAMwB,sBAAsBnB,YAAa,CAAAN,aAAA,CAAA,CAAA;IAEzC,IAAM0B,iBAAoB,GAAA1B,aAAA,IAAiBM,YAAe,GAAAmB,mBAAA,GAAsB,EAAC,CAAA;AAE1E,IAAA,OAAAE,aAAA,CAAAA,aAAA,KACD,OAAOH,MAAW,KAAA,UAAA,GAAcA,QAAwB,GAAAA,MAAA,GACxDE,qBAAqB,EAAC,CAAA,CAAA;GAE3B,EAAA,CAAC1B,aAAe,EAAAC,aAAA,EAAeK,YAAY,CAAC,CAAA,CAAA;AAExC,EAAA,OAAA,CAACgB,iBAAiBf,eAAe,CAAA,CAAA;AAC1C;;;;"}