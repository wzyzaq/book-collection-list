{"version":3,"file":"helper.js","sources":["../../../../components/cascader/core/helper.ts"],"sourcesContent":["import { isEmpty } from 'lodash-es';\nimport {\n  TreeNode,\n  CascaderContextType,\n  TdCascaderProps,\n  CascaderValue,\n  TreeNodeValue,\n  TreeOptionData,\n} from '../interface';\n\n/**\n * 单选状态下内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getSingleContent(cascaderContext: CascaderContextType): string {\n  const { value, multiple, treeStore, showAllLevels } = cascaderContext;\n  const BooleanIsFalseExceptZero = 0;\n  if (multiple || (!value && value !== BooleanIsFalseExceptZero)) return '';\n\n  if (Array.isArray(value)) return '';\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!(node && node.length)) {\n    return value as string;\n  }\n  const path = node && node[0].getPath();\n  if (path && path.length) {\n    return showAllLevels ? path.map((node: TreeNode) => node.label).join(' / ') : path[path.length - 1].label;\n  }\n  return value as string;\n}\n\n/**\n * 多选状态下选中内容\n * @param isHover\n * @param cascaderContext\n * @returns\n */\nexport function getMultipleContent(cascaderContext: CascaderContextType) {\n  const { value, multiple, treeStore, showAllLevels } = cascaderContext;\n\n  if (!multiple) return [];\n  if (multiple && !Array.isArray(value)) return [];\n\n  const node = treeStore && treeStore.getNodes(value as TreeNodeValue | TreeNode);\n  if (!node) return [];\n\n  return (value as TreeNodeValue[])\n    .map((item: TreeNodeValue) => {\n      const node = treeStore.getNodes(item);\n      return showAllLevels ? getFullPathLabel(node?.[0]) : node?.[0]?.label;\n    })\n    .filter((item) => !!item);\n}\n\n/**\n * 面板数据计算方法\n * @param treeNodes\n * @returns\n */\nexport function getPanels(treeNodes: CascaderContextType['treeNodes']) {\n  const panels: TreeNode[][] = [];\n  treeNodes.forEach((node: TreeNode) => {\n    if (panels[node.level]) {\n      panels[node.level].push(node);\n    } else {\n      panels[node.level] = [node];\n    }\n  });\n  return panels;\n}\n\n/**\n * 获取node的全部路径\n * @param node\n * @returns\n */\nexport function getFullPathLabel(node: TreeNode, separator = '/') {\n  return node\n    ?.getPath()\n    .map((node: TreeNode) => node.label)\n    .join(separator);\n}\n\n/**\n * treeValue计算方法\n * @param value\n * @returns\n */\nexport const getTreeValue = (value: CascaderContextType['value']) => {\n  let treeValue: TreeNodeValue[] = [];\n  if (Array.isArray(value)) {\n    if (value.length > 0 && typeof value[0] === 'object') {\n      treeValue = (value as TreeOptionData[]).map((val) => val.value);\n    } else if (value.length) {\n      treeValue = value as TreeNodeValue[];\n    }\n  } else if (value) {\n    if (typeof value === 'object') {\n      treeValue = [(value as TreeOptionData).value];\n    } else {\n      treeValue = [value];\n    }\n  }\n  return treeValue;\n};\n\n/**\n * 按数据类型计算通用数值\n * @param value\n * @param showAllLevels\n * @param multiple\n * @returns\n */\nexport const getCascaderValue = (value: CascaderValue, valueType: TdCascaderProps['valueType'], multiple: boolean) => {\n  if (valueType === 'single') {\n    return value;\n  }\n  if (multiple) {\n    return (value as Array<CascaderValue>).map((item: TreeNodeValue[]) => item[item.length - 1]);\n  }\n  return value[(value as Array<CascaderValue>).length - 1];\n};\n\n/**\n * 空值校验\n * 补充value为Number时的空值校验逻辑，排除NaN\n * @param value\n * @returns\n */\nexport function isEmptyValues(value: unknown): boolean {\n  if (typeof value === 'number' && !isNaN(value)) return false;\n  return isEmpty(value);\n}\n\n/**\n * 初始化数据校验\n * @param value\n * @param cascaderContext\n * @returns boolean\n */\nexport function isValueInvalid(value: CascaderValue, cascaderContext: CascaderContextType) {\n  const { multiple, showAllLevels } = cascaderContext;\n  return (multiple && !Array.isArray(value)) || (!multiple && Array.isArray(value) && !showAllLevels);\n}\n"],"names":["getSingleContent","cascaderContext","value","multiple","treeStore","showAllLevels","BooleanIsFalseExceptZero","Array","isArray","node","getNodes","length","path","getPath","map","label","join","getMultipleContent","item","_node2$","getFullPathLabel","filter","getPanels","treeNodes","panels","forEach","level","push","separator","arguments","undefined","getTreeValue","treeValue","_typeof","val","getCascaderValue","valueType","isEmptyValues","isNaN","isEmpty","isValueInvalid"],"mappings":"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"}