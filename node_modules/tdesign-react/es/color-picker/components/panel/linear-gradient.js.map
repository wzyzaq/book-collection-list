{"version":3,"file":"linear-gradient.js","sources":["../../../../../components/color-picker/components/panel/linear-gradient.tsx"],"sourcesContent":["import React, { KeyboardEvent, MouseEvent as ReactMouseEvent, useCallback, useEffect, useRef, useState } from 'react';\nimport { cloneDeep } from 'lodash-es';\nimport classNames from 'classnames';\nimport { genGradientPoint, gradientColors2string } from '@tdesign/common-js/color-picker/color';\nimport { GradientColorPoint } from '@tdesign/common-js/color-picker/gradient';\nimport { GRADIENT_SLIDER_DEFAULT_WIDTH } from '@tdesign/common-js/color-picker/constants';\nimport useCommonClassName from '../../../hooks/useCommonClassName';\nimport useClassName from '../../hooks/useClassNames';\nimport InputNumber from '../../../input-number';\n\nconst DELETE_KEYS: string[] = ['delete', 'backspace'];\n\ntype TSliderRect = {\n  left: number;\n  width: number;\n};\n\nconst LinearGradient = (props) => {\n  const { onChange, color, disabled } = props;\n  const baseClassName = useClassName();\n  const { STATUS: statusClassNames } = useCommonClassName();\n  const refSlider = useRef<HTMLDivElement>(null);\n  const sliderRectRef = useRef<TSliderRect>({\n    left: 0,\n    width: GRADIENT_SLIDER_DEFAULT_WIDTH,\n  });\n  const isDragging = useRef<Boolean>(false);\n  const isMoved = useRef<Boolean>(false);\n  const degree = useRef(props.color.gradientDegree);\n  const [selectedId, setSelectedId] = useState(props.color.gradientSelectedId);\n  const selectedRef = useRef(props.color.gradientSelectedId);\n  const colors = useRef<GradientColorPoint[]>(cloneDeep(color.gradientColors));\n  const [colorsState, setColorsState] = useState<GradientColorPoint[]>(colors.current);\n\n  useEffect(() => {\n    degree.current = color?.gradientDegree;\n    setSelectedId(color.gradientSelectedId);\n    selectedRef.current = color.gradientSelectedId;\n    colors.current = cloneDeep(color.gradientColors);\n    setColorsState(colors.current);\n  }, [color.gradientColors, color?.gradientDegree, color.gradientSelectedId, color.value, color.saturation]);\n\n  const updateSliderRect = () => {\n    const rect = refSlider.current.getBoundingClientRect();\n    sliderRectRef.current = {\n      left: rect.left,\n      width: rect.width || GRADIENT_SLIDER_DEFAULT_WIDTH,\n    };\n  };\n\n  const handleChange = useCallback(\n    (key: 'degree' | 'selectedId' | 'colors', payload: any, addUsedColor?: boolean) => {\n      if (disabled) {\n        return;\n      }\n      onChange({\n        key,\n        payload,\n        addUsedColor,\n      });\n    },\n    [onChange, disabled],\n  );\n\n  const handleDegreeChange = (value: number) => {\n    if (props.disabled || value === props.color.gradientDegree) {\n      return;\n    }\n    degree.current = value;\n    handleChange('degree', value, true);\n  };\n\n  const handleSelectedIdChange = (value: string) => {\n    if (props.disabled) {\n      return;\n    }\n    setSelectedId(value);\n    selectedRef.current = value;\n    handleChange('selectedId', value);\n  };\n\n  const handleColorsChange = useCallback(\n    (value: GradientColorPoint[], isEnded?: boolean) => {\n      if (props.disabled) {\n        return;\n      }\n      colors.current = value;\n      setColorsState(value);\n      handleChange('colors', value, isEnded);\n    },\n    [props.disabled, handleChange],\n  );\n\n  /**\n   * 设置bar的位置\n   * @param left\n   * @returns\n   */\n  const updateActiveThumbLeft = useCallback(\n    (left: number) => {\n      const index = colors.current.findIndex((c) => c.id === selectedRef.current);\n      if (index === -1) {\n        return;\n      }\n      const point = colors.current[index];\n      const formatLeft = Math.max(0, Math.min(sliderRectRef.current.width, left));\n\n      const percentLeft = (formatLeft / sliderRectRef.current.width) * 100;\n\n      const newColors = colors.current.map((item, i) =>\n        index !== i\n          ? item\n          : {\n              color: point.color,\n              left: percentLeft,\n              id: point.id,\n            },\n      );\n\n      handleColorsChange(newColors);\n    },\n    [handleColorsChange],\n  );\n\n  // 移动开始\n  const handleStart = (id: string, e: ReactMouseEvent) => {\n    if (isDragging.current || props.disabled) {\n      return;\n    }\n    selectedRef.current = id;\n    setSelectedId(id);\n    isMoved.current = false;\n    isDragging.current = true;\n    e.preventDefault();\n    e.stopPropagation();\n    // handleSelectedIdChange(id);\n    // 让 slider 获取焦点，以便键盘事件生效。\n    refSlider.current.focus();\n  };\n\n  // 移动中\n  const handleMove = useCallback(\n    (e: MouseEvent) => {\n      if (!isDragging.current || disabled) {\n        return;\n      }\n\n      const rect = refSlider.current.getBoundingClientRect();\n      const left = e.clientX - rect.x;\n      isMoved.current = true;\n      updateActiveThumbLeft(left);\n    },\n    [disabled, updateActiveThumbLeft],\n  );\n\n  // 移动结束\n  const handleEnd = useCallback(() => {\n    if (!isDragging.current) {\n      return;\n    }\n    setTimeout(() => {\n      isDragging.current = false;\n    }, 0);\n    if (isMoved.current) {\n      handleColorsChange(colors.current, true);\n      isMoved.current = false;\n    }\n  }, [handleColorsChange]);\n\n  const handleKeyup = (e: KeyboardEvent) => {\n    if (props.disabled) {\n      return;\n    }\n    const points = [...colors.current];\n    let pos = points.findIndex((c) => c.id === selectedRef.current);\n    const { length } = points;\n    // 必须保证有两个点\n    if (DELETE_KEYS.includes(e.key.toLocaleLowerCase()) && length > 2 && pos >= 0 && pos <= length - 1) {\n      points.splice(pos, 1);\n      if (!points[pos]) {\n        // eslint-disable-next-line no-nested-ternary\n        pos = points[pos + 1] ? pos + 1 : points[pos - 1] ? pos - 1 : 0;\n      }\n      const current = points[pos];\n      handleColorsChange(points, true);\n      handleSelectedIdChange(current?.id);\n    }\n  };\n\n  const handleThumbBarClick = (e: ReactMouseEvent) => {\n    if (props.disabled || !props.enableMultipleGradient) {\n      return;\n    }\n    updateSliderRect();\n\n    let left = e.clientX - sliderRectRef.current.left;\n    left = Math.max(0, Math.min(sliderRectRef.current.width, left));\n    const percentLeft = (left / sliderRectRef.current.width) * 100;\n\n    const newPoint = genGradientPoint(percentLeft, props.color.rgba);\n    const newColors = [...colors.current];\n    newColors.push(newPoint);\n    handleColorsChange(newColors, true);\n    handleSelectedIdChange(newPoint.id);\n  };\n\n  useEffect(() => {\n    updateSliderRect();\n\n    window.addEventListener('mousemove', handleMove, false);\n    window.addEventListener('mouseup', handleEnd, false);\n    window.addEventListener('contextmenu', handleEnd, false);\n\n    return () => {\n      window.removeEventListener('mousemove', handleMove, false);\n      window.removeEventListener('mouseup', handleEnd, false);\n      window.removeEventListener('contextmenu', handleEnd, false);\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  const { gradientColors } = props.color;\n\n  const thumbBackground = gradientColors2string({\n    points: gradientColors,\n    degree: 90,\n  });\n\n  const handleClickThumb = (e: ReactMouseEvent, t) => {\n    handleSelectedIdChange(t.id);\n    e.stopPropagation();\n  };\n\n  const allGradientColors = [...colorsState];\n  const { color: leftColor } = genGradientPoint(0, allGradientColors[0]?.color);\n  const { color: rightColor } = genGradientPoint(100, allGradientColors[allGradientColors.length - 1]?.color);\n\n  return (\n    <div className={`${baseClassName}__gradient`}>\n      <div\n        className={`${baseClassName}__gradient-slider`}\n        style={{\n          background: `linear-gradient(90deg, ${leftColor} 0%, ${leftColor} 50%, ${rightColor} 50%, ${rightColor} 100%)`,\n        }}\n      >\n        <div\n          className={classNames(`${baseClassName}__slider`, `${baseClassName}--bg-alpha`)}\n          onKeyUp={handleKeyup}\n          tabIndex={0}\n          ref={refSlider}\n        >\n          <ul\n            className=\"gradient-thumbs\"\n            onClick={handleThumbBarClick}\n            style={{\n              background: thumbBackground,\n            }}\n          >\n            {colorsState.map((t) => {\n              const left = `${Math.round(t.left * 100) / 100}%`;\n              return (\n                <li\n                  className={classNames([\n                    `${baseClassName}__thumb`,\n                    'gradient-thumbs__item',\n                    selectedId === t.id ? statusClassNames.active : '',\n                  ])}\n                  key={t.id}\n                  title={`${t.color} ${left}`}\n                  style={{\n                    color: t.color,\n                    left,\n                  }}\n                  onClick={(e) => handleClickThumb(e, t)}\n                  onMouseDown={(e: ReactMouseEvent) => handleStart(t.id, e)}\n                >\n                  <span className={classNames(['gradient-thumbs__item-inner', `${baseClassName}--bg-alpha`])}></span>\n                </li>\n              );\n            })}\n          </ul>\n        </div>\n      </div>\n      <div className={`${baseClassName}__gradient-degree`} title={`${degree}deg`}>\n        <InputNumber\n          theme=\"normal\"\n          min={0}\n          max={360}\n          step={1}\n          size=\"small\"\n          format={(value: number) => `${value}°`}\n          value={degree.current}\n          onBlur={handleDegreeChange}\n          onEnter={handleDegreeChange}\n          onChange={handleDegreeChange}\n          disabled={props.disabled}\n        />\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(LinearGradient);\n"],"names":["DELETE_KEYS","LinearGradient","props","_allGradientColors$","_allGradientColors","onChange","color","disabled","baseClassName","useClassName","_useCommonClassName","useCommonClassName","statusClassNames","STATUS","refSlider","useRef","sliderRectRef","left","width","GRADIENT_SLIDER_DEFAULT_WIDTH","isDragging","isMoved","degree","gradientDegree","_useState","useState","gradientSelectedId","_useState2","_slicedToArray","selectedId","setSelectedId","selectedRef","colors","cloneDeep","gradientColors","_useState3","current","_useState4","colorsState","setColorsState","useEffect","value","saturation","updateSliderRect","rect","getBoundingClientRect","handleChange","useCallback","key","payload","addUsedColor","handleDegreeChange","handleSelectedIdChange","handleColorsChange","isEnded","updateActiveThumbLeft","index","findIndex","c","id","point","formatLeft","Math","max","min","percentLeft","newColors","map","item","i","handleStart","e","preventDefault","stopPropagation","focus","handleMove","clientX","x","handleEnd","setTimeout","handleKeyup","points","_toConsumableArray","pos","length","includes","toLocaleLowerCase","splice","handleThumbBarClick","enableMultipleGradient","newPoint","genGradientPoint","rgba","push","window","addEventListener","removeEventListener","thumbBackground","gradientColors2string","handleClickThumb","t","allGradientColors","_genGradientPoint","leftColor","_genGradientPoint2","rightColor","React","createElement","className","style","background","concat","classNames","onKeyUp","tabIndex","ref","onClick","round","active","title","onMouseDown","InputNumber","theme","step","size","format","onBlur","onEnter","memo"],"mappings":"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"}